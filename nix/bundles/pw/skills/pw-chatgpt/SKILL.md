---
name: pw-chatgpt
description: Agent-to-ChatGPT conversation using `pw` (send messages, attach files, download artifacts). Trigger when user wants to interact with ChatGPT.
---

# ChatGPT Automation

Automate ChatGPT conversations using `pw` browser automation and the `chatgpt.nu` Nushell script.

## Setup

Requires CDP connection to your browser with an active ChatGPT session:

```bash
pw connect --launch    # launch browser with debugging
pw navigate https://chatgpt.com
```

## Invocation

```bash
# from scripts dir
use chatgpt.nu *
chatgpt ask "Hello"

# from anywhere (bash)
nu -I ~/.claude/skills/pw-chatgpt/scripts -c 'use chatgpt.nu *; chatgpt ask "Hello"'
```

## Connecting to Existing Session

When user has an open ChatGPT tab and wants to continue a conversation:

```bash
chatgpt history                  # get full conversation context
chatgpt history --last 4         # or just recent exchanges
```

If user claims session already open, commands above should just work with no extra setup.

## Commands

### chatgpt ask

Send message, wait for response, return response text.

```bash
chatgpt ask "Simple question"             # returns response text
chatgpt ask --file prompt.md              # complex text with backticks/escapes
"multi\nline" | chatgpt ask               # stdin
chatgpt ask "Hello" --model=instant --new
chatgpt ask "Hello" --json                # full record with metadata
```

Note: do not attempt to send multiple consecutive messages in a row, this will not work. You must compile everything needed into 1 message. Multiple attachments allowed.

### chatgpt send

Send message without waiting.

```bash
chatgpt send "Hello"
chatgpt send --file prompt.md
"text" | chatgpt send --model=thinking
```

### chatgpt attach

Attach file as document. Best for large text (250KB+).

```bash
chatgpt attach --file codemap.md --prompt "Review this" --send
open file.txt | chatgpt attach --name "doc.txt"
```

From bash, use `--file` for complex text (avoids shell escaping issues):

```bash
nu -I ~/.claude/skills/pw-chatgpt/scripts -c 'use chatgpt.nu *; chatgpt ask --file prompt.md'
nu -I ~/.claude/skills/pw-chatgpt/scripts -c 'use chatgpt.nu *; chatgpt attach --file doc.md --send'
```

### chatgpt paste

Inline text paste. Limit ~50KB (UI freezes on larger).

```bash
"short text" | chatgpt paste --send
cat file.rs | chatgpt paste --clear
```

### chatgpt set-model

```bash
chatgpt set-model thinking  # auto | instant | thinking
```

### chatgpt new

Start fresh temp chat.

```bash
chatgpt new                # defaults to thinking model
chatgpt new --model=auto
```

### chatgpt wait

Wait for response completion. Use 10min+ timeout; thinking model can take a while.

```bash
chatgpt wait                   # default 20min
chatgpt wait --timeout=600000  # 10min minimum recommended
```

### chatgpt get-response

Get last assistant message text.

### chatgpt history

Get full conversation history (all user and assistant messages).

```bash
chatgpt history                  # readable transcript
chatgpt history --last 2         # last user/assistant exchange
chatgpt history --json           # JSON
chatgpt history --raw | where role == "user"   # nushell records
```

### chatgpt refresh

Reload page when UI stuck.

### chatgpt download

Download files generated by ChatGPT.

```bash
chatgpt download                      # download last file to stdout
chatgpt download -o output.md         # save to file
chatgpt download --list               # list all available downloads
chatgpt download --index 0            # download specific file by index
```

Note: You can ask for downloadable files from ChatGPT by explicitly prompting them to use the `python_user_visible` tool and providing a link in chat like: `sandbox:/mnt/data/<filename>`.

## Collaborative Discussions

For agent-to-ChatGPT collaboration (e.g., planning, code review):

1. Attach context first - upload a codemap or relevant file to give ChatGPT background
2. Be collaborative - switch between checking real code and talking to ChatGPT; have back-and-forths
3. Ask for clarification - ask if ChatGPT needs more detail in specific areas for better guidance
4. Request deliverables - when wrapping up, ask for a comprehensive plan with checkboxes and code sketches
5. Download artifacts - use `chatgpt download` to save generated plans/code to disk

Example workflow:

```bash
chatgpt attach --file codemap.md --prompt "Review this codebase structure" --send
chatgpt wait
chatgpt get-response
# ... discuss, iterate ...
chatgpt ask "Give me a multi-phased implementation plan with checkboxes"
chatgpt download -o plan.md
```

## Selectors

| Element       | Selector                                 |
| ------------- | ---------------------------------------- |
| Input         | `#prompt-textarea`                       |
| Model button  | `button[aria-label^="Model selector"]`   |
| Send button   | `[data-testid="send-button"]`            |
| Stop button   | `button[aria-label="Stop streaming"]`    |
| Thinking      | `.result-thinking`                       |
| Assistant msg | `[data-message-author-role="assistant"]` |

## Gotchas

- Use `--file` for prompts with backticks/code blocks; complex inlines can break nushell
- Always timeout 10min+ for responses; thinking model takes time
- Radix dropdowns close between `pw` commands; script uses async polling
- UI sometimes stuck with loading dot; `chatgpt refresh` to recover
- `#prompt-textarea` is contentEditable div, not textarea
- Attachment filenames show as UUIDs in UI but content works
- Strip time estimates from downloaded plans (they're usually inaccurate)
